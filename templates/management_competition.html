<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Management Competition</title>
  <link rel="stylesheet" href="/static/css/main.css">
  <link rel="stylesheet" href="/static/css/competition.css">
</head>
<body>

<nav class="navbar">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/management_competition">Competition Analysis</a></li>
      <!-- Pushes the link to the far right -->
    <li style="margin-left:auto;">
      <a href="#" id="viewCalendarLink" style="color:#58A6FF;font-weight:600;text-decoration:none;">
        View Calendar
      </a>
    </li>
  </ul>
</nav>

<div class="content">
  <div class="panel">
    <h3>Competition & Threat Analysis</h3>
    <form id="competitionForm" action="/management_competition/analyze" method="POST" novalidate>
      <input name="symbol" id="symbol" type="text" placeholder="Symbol (e.g. GOOG)" required>
      <select name="report" id="report">
        <option value="K10">K10</option>
        <option value="Q10">Q10</option>
      </select>
      <input name="year" id="year" type="number" placeholder="Year (e.g. 2024)" min="1900" max="2030" required>
      <button type="submit">
        <span class="spinner"></span>
        <span>Search</span>
      </button>

    </form>
    <div id="errorMsg"></div>
    <div id="result"></div>
  </div>
</div>

<script>
  // "View Calendar" click handler
  document.getElementById("viewCalendarLink").addEventListener("click", function (e) {
    e.preventDefault();

    const symbol = document.querySelector("input[name='symbol']").value.trim();
    const year   = document.querySelector("input[name='year']").value.trim();

    if (!symbol || !year) {
      alert("⚠️ Please enter both Symbol and Year before viewing the calendar.");
      return;
    }

    window.open(
      `/calendar/view?symbol=${encodeURIComponent(symbol)}&year=${year}`,
      "CalendarPopup",
      "width=900,height=600,menubar=no,toolbar=no,scrollbars=yes,resizable=yes"
    );
  });
</script>

<script src="/static/js/competition.js"></script>
</body>
</html>
